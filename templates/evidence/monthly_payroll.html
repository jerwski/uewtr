{% extends 'base.html' %}
{% load bootstrap4 %}
{% load utility_tags %}
{% load static %}

{% block title %}Monthly payroll{% endblock %}

{% block content %}

  <div class="container-fluid">
    <div class="row">
      <div class="col-2 text-center">
        <div class="btn btn-group-vertical mt-3" role="group">
          <a class="btn btn-outline-dark d-print-none" href="{% url 'account:admin_site' %}">Dashboard</a>
          <a class="btn btn-outline-primary d-print-none" href="{% url 'evidence:working_time_recorder_add' employee_id %}">Work time recorder</a>
          <a class="btn btn-outline-success d-print-none" href="{% url 'evidence:leave_time_recorder_add' employee_id %}">Leave time recorder</a>
          <a class="btn btn-outline-secondary d-print-none" href="{% url 'evidence:account_payment' employee_id %}">Payment on account</a>
          {% if amountpay.brutto > 0 %}
            <a class="btn btn-outline-info d-print-none" href="{% url 'evidence:monthly_payroll_print' month year %}">Print</a>
            <a class="btn btn-outline-warning d-print-none" href="{% url 'evidence:monthly_payroll_pdf' month year %}">Send PDF</a>
          {% else %}
            <a class="btn btn-outline-info d-print-none disabled" href="{% url 'evidence:monthly_payroll_print' month year %}">Print</a>
            <a class="btn btn-outline-warning d-print-none disabled" href="{% url 'evidence:monthly_payroll_pdf' month year %}">Send PDF</a>
          {% endif %}
          <a class="btn btn-outline-danger d-print-none" href="{% url 'account:exit' %}">Exit</a>
        </div>
        <hr class="small">

        <form action="{% url 'evidence:monthly_payroll_view' %}" method="POST">{% csrf_token %}
          {% bootstrap_field form.choice_date label_class='text-primary font-weight-bold' %}
          <div class="btn btn-block">
            <button type="submit" class="btn btn-lg btn-outline-success btn-block">Confirm date</button>
          </div>
        </form>

        <hr class="small">
        <div class="col">
          <a href="{% url 'account:admin_site' %}">
            <img class="d-block uk-logo mx-auto" src="{% static 'images/mainboard/logoUNI.png' %}" alt="Logo Unikolor">
            <span class="d-block uk-text-logo">&copy;Copyright<br>UNIKOLOR Jerzy Wygonowski</span>
          </a>
        </div>
      </div>
      <div class="col-10">
        {% if amountpay.brutto %}
          {% include 'blocks/payrolldata_modal.html' %}
          <p class="uk-headline">Total work hours: {{ total_work_hours }} hours.&nbsp;&nbsp;&nbsp;Total payment: {{ amountpay.brutto|money_format }}</p>

          <div class="input-group">
            <input class="form-control" id="myInput" type="text" placeholder="Search employee..." aria-label="Filtering table" aria-describedby="basic-addon">
            <div class="input-group-append">
              <span class="input-group-text fas fa-search" id="basic-addon"></span>
            </div>
          </div>

          <table class="uk-table table-striped">
            <thead class="text-center bg-info">
              <tr>{% for head in heads %}<th>{{ head }}</th>{% endfor %}</tr>
            </thead>
            <tbody id="searchTable">
            {% for name, data in payroll.items %}
              {% if data.brutto > 0 %}
                <tr class="text-dark text-right">
                  <td class="text-left font-weight-bold font-italic"><a class="text-primary" href="{% employee_complex_data_pass name.employee_complex_data month year %}">{{ forloop.counter }}.&nbsp;{{ name }}</a></td>
                  <td>{{ data.brutto|money_format }}</td>
                  <td>{{ data.basicpay|money_format }}</td>
                  <td>{{ data.leavepay|money_format }}</td>
                  <td>{{ data.overhourspay|money_format }}</td>
                  <td>{{ data.satpay|money_format }}</td>
                  <td>{{ data.sunpay|money_format }}</td>
                  <td>{{ data.accountpay|money_format }}</td>
                  <td>{{ data.salary|money_format }}</td>
                </tr>
              {% endif %}
            {% endfor %}
              <tr class="bg-info"><td class="text-right text-white font-weight-bold">TOTAL:</td>
              {% for value in amountpay.values %}
                <td class="text-right text-white font-weight-bold">{{ value|money_format }}</td>
              {% endfor %}
              </tr>
            </tbody>
          </table>
        {% elif not amountpay %}
          <div class="jumbotron bg-warning mt-lg-5 text-center">
            <p class="uk-text-middle">Your choice: {{ month }}/{{ year }}r. Total work hours: {{ total_work_hours }} hours.<br>For {{ month }}/{{ year }} no data available in database!</p>
          </div>
        {% else %}
          <div class="jumbotron bg-warning mt-lg-5 text-center">
            <p class="uk-text-middle">Your choice: {{ month }}/{{ year }}r. Total work hours: {{ total_work_hours }} hours.<br>For {{ month }}/{{ year }} no data available in database!</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

{% endblock %}
